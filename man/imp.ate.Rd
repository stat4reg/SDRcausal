% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/imp.ate.R
\name{imp.ate}
\alias{imp.ate}
\title{Estimates Average Treatment Effect (ATE) by imputation (IMP)}
\usage{
imp.ate(
  x,
  y,
  treated1,
  beta_guess1,
  beta_guess0,
  solver = "optim",
  kernel = "EPAN",
  explicit_bandwidth = FALSE,
  recalc_bandwidth = FALSE,
  bwc_dim_red1 = 1,
  bwc_impute1 = 1,
  bwc_dim_red0 = 1,
  bwc_impute0 = 1,
  gauss_cutoff = 0.001,
  penalty = 10,
  n_before_pen = 5,
  to_extrapolate = TRUE,
  to_truncate = TRUE,
  extrapolation_basis = 5,
  n_threads = 1,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{x}{Covariate matrix}

\item{y}{Response vector}

\item{treated1}{Binary vector indicating treatment.}

\item{beta_guess1}{Initial guess of beta for m1}

\item{beta_guess0}{Initial guess of beta for m0}

\item{solver}{Specifies which solver to be used. Current options
optim and cobyla (from nloptr package).}

\item{kernel}{Specifies which kernel function to be used,
current options are: "EPAN", "QUARTIC", and
"GAUSSIAN".}

\item{explicit_bandwidth}{Specifies if bandwidth_scale will be used as the
bandwidth or if it will be calculated as bw =
bandwidth_scale * sd(x * beta) * n^(1/3).}

\item{recalc_bandwidth}{Specifies wheter the bandwidth should be
recalculated after the estimation of alpha
(cms.ps.semi).}

\item{bwc_dim_red1}{Scaling of calculated bandwidth, or if
explicit_bandwidth = TRUE used as the banddwidth.
For dimension reduction (cms.semi).}

\item{bwc_impute1}{Scaling of calculated bandwidth, or if
explicit_bandwidth = TRUE used as the banddwidth.
Recalculated if explicit_bandwidth = FALSE and
recalc_bandwidth = TRUE. For imputation.}

\item{bwc_dim_red0}{See bwc_dim_red1}

\item{bwc_impute0}{See bwc_impute1}

\item{gauss_cutoff}{Cutoff value for Gaussian kernel}

\item{penalty}{Penalty for the optimizer if local linear
regression fails. Added to the function value in
solver as: penalty^(n - n_before_pen), where n is
the number of llr fails.}

\item{n_before_pen}{Number of probabilities outside the range (0, 1)
to accept during dimension reduction.}

\item{to_extrapolate}{Specifies wheter to extrapolate or not}

\item{to_truncate}{Specifies wheter to extrapolate or not}

\item{extrapolation_basis}{Number of data point to base extrapolation on.}

\item{n_threads}{Sets number of threads for parallel run. Set to 0
serial. If n_threads exceeds maximum number of
threads, sets n_threads to max_threads - 1. To
use max_threads, set to n_threads to max_threads
of system.}

\item{verbose}{Specifies if the program should print output
while running.}

\item{...}{Additional parameters passed to optim.}
}
\value{
A list containing the average treatment effect of the
        combination of observed and imputed values (ate), the average
        treatment effect based on the imputed values only (ate2), the
        imputed values for treated (m1) and untreated treated (m0), the and
        the output from optim (op).
}
\description{
Semiparametric estimation of the average treatment effect based
             on the imputation method described in Ghosh, Ma, & De Luna
             (2020).
}
\examples{
# Using example data from package SDRcausal
library(SDRcausal)

# Import example data
x <- SDRcausal::covariates
y <- SDRcausal::outcomes
trt <- SDRcausal::treated
b1 <- SDRcausal::beta1_guess
b0 <- SDRcausal::beta0_guess

# Perform semiparametric imputation
imp <- SDRcausal::imp.ate(x, y, trt, b1, b0,
           explicit_bandwidth = TRUE, bwc_dim_red1 = 1, bwc_impute1 = 1,
           bwc_dim_red0 = 1, bwc_impute0 = 1)

}
\references{
Ghosh, T., Ma, Y., & De Luna, X. (2020). Sufficient dimension
reduction for feasible and robust estimation of average causal effect.
Statistica Sinica, accepted.
}
\seealso{
[stats::optim]
}
